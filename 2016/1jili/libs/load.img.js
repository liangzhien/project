(function(window){function ImgLoader(property,options){var onloadedcompleted,onloading,NUM_ELEMENTS=0,NUM_LOADED=0,NUM_ERROR=0,TempProperty={},LOADED_THEMES={},NUM_MEDIA_COUNT=0,NUM_MEDIA_LOADED=0,NUM_MEDIA_ERROR=0;var timerId=null;this.assets=TempProperty;this.asset=LOADED_THEMES;this.load=function(prop,opt){var loadList=[];if(typeof(prop)=='string'){loadList[0]=prop}else if(Object.prototype.toString.apply(prop)=='[object Array]'){loadList=prop;if(typeof(opt)=='function'){onloadedcompleted=opt;onloading=typeof(arguments[2])=='function'?arguments[2]:onloading}else if(typeof(opt)=='object'){onloadedcompleted=opt['completed']||onloadedcompleted;onloading=opt['progress']||onloading}}else if(typeof(prop)=='object'){loadList=prop['assets']||[];onloadedcompleted=prop['completed']||onloadedcompleted;onloading=prop['progress']||onloading}for(var i=0;i<loadList.length;i++){var src=loadList[i];if(TempProperty[src]!=undefined){continue}if(/\.jpg$|\.jpeg$|\.png$|\.gif$/.test(src.toLowerCase())){NUM_ELEMENTS++;loadImg(src)}else if(/\.mp3$|\.ogg$|\.wav$/.test(src.toLowerCase())){NUM_MEDIA_COUNT++;loadAudio(src)}else if(/\.mp4$|\.webm$|\.ogv$/.test(src.toLowerCase())){NUM_MEDIA_COUNT++;loadVideo(src)}else{NUM_ELEMENTS++;NUM_ERROR++;assetsLoaded()}}};function loadImg(img){var image=new Image();image.addEventListener("load",function(e){NUM_LOADED++;assetsLoaded();this.removeEventListener("load",arguments.callee,false)},false);image.addEventListener("error",function(e){NUM_ERROR++;assetsLoaded();this.removeEventListener("error",arguments.callee,false)},false);image.src=img;TempProperty[img]=image};function loadAudio(audio){var music=new Audio();music.addEventListener("canplay",function(e){NUM_MEDIA_LOADED++;assetsLoaded();this.removeEventListener("canplay",arguments.callee,false)},false);music.addEventListener("error",function(e){NUM_MEDIA_ERROR++;assetsLoaded();this.removeEventListener("error",arguments.callee,false)},false);music.src=audio;music.load();TempProperty[audio]=music};function loadVideo(video){var music=document.createElement('video');music.addEventListener("canplay",function(e){NUM_MEDIA_LOADED++;assetsLoaded();this.removeEventListener("canplay",arguments.callee,false)},false);music.addEventListener("error",function(e){NUM_MEDIA_ERROR++;assetsLoaded();this.removeEventListener("error",arguments.callee,false)},false);music.src=video;music.load();TempProperty[video]=music};function checkProgress(){var progress=!!(NUM_ELEMENTS+NUM_MEDIA_COUNT)?Math.floor((NUM_LOADED+NUM_MEDIA_LOADED+NUM_ERROR+NUM_MEDIA_ERROR)/(NUM_ELEMENTS+NUM_MEDIA_COUNT)*100):100;return{"progress":progress,"loaded":NUM_LOADED+NUM_MEDIA_LOADED,"error":NUM_ERROR+NUM_MEDIA_ERROR,"total":NUM_ELEMENTS+NUM_MEDIA_COUNT}};function assetsLoaded(){var data=checkProgress();if(data.progress>=100){clearTimeout(timerId);typeof(onloading)=='function'&&onloading(100,data);timerId=setTimeout(function(){typeof(onloadedcompleted)=='function'&&onloadedcompleted(Math.min(100,data.progress),data)},500)}else{typeof(onloading)=='function'&&onloading(Math.min(100,data.progress),data)}};this.load.apply(this,arguments)};if(typeof define==="function"&&define.amd){define("ImgLoader",[],function(){return ImgLoader})}window.ImgLoader=ImgLoader})(typeof window!=="undefined"?window:this);